Goals:
 - Write up of the current status of Diagnsotics in AOT
 - Proposal for way forward including 8.0 recommendations

 Resources
  - https://docs.microsoft.com/en-us/dotnet/core/diagnostics/


Local resources:
 - laptop
  - C:\work\core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging


A) - Logging
..\..\..\..\..\run.bat

C:\work\core\Tools\PerfView.exe

DiagnsoticSource, EventSource

Demo:1:4

1) .NET
 
dotnet publish -r win-x64 --self-contained true

C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\EventSource\DotNet\bin\Debug\net7.0\win-x64\publish\DotNetTest.exe
71 MB (with App size around 152 KB)

a) PerfView
Can See events (see below for nettrace stats)

b) dotnet-trace
pushd C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\EventSource\DotNet\bin\Debug\net7.0\win-x64\publish

dotnet-trace collect --providers Demo -- DotNetTest.exe

Ex. DotNetTest.exe_20221106_060019.nettrace (152 KB)

C:\work\core\Test\8_18\sdk\Diagnostics\EventSource\DotNet\bin\Debug\net7.0\win-x64\publish\DotNetTest.exe_20220829_162804.nettrace

Can see events

Name	Count	AverageSize	StackCount
Microsoft-Windows-DotNETRuntimeRundown/Method/DCStopVerbose	620	262	0
Microsoft-Windows-DotNETRuntimeRundown/Method/ILToNativeMapDCStop	20	271	0
Microsoft-Windows-DotNETRuntimeRundown/Loader/ModuleDCStop	4	576	0
Microsoft-Windows-DotNETRuntimeRundown/Loader/DomainModuleDCStop	4	324	0
Microsoft-Windows-DotNETRuntimeRundown/Loader/AssemblyDCStop	4	196	0
Demo/DebugMessage	2	49	2
Demo/AppStarted	1	50	1
Demo/Request/Start	1	4	1
Demo/Request/Stop	1	4	1
Microsoft-DotNETCore-EventPipe/ProcessInfo	1	58	0
Microsoft-Windows-DotNETRuntimeRundown/Runtime/Start	1	309	0
Microsoft-Windows-DotNETRuntimeRundown/Method/DCStopInit	1	2	0
Microsoft-Windows-DotNETRuntimeRundown/Loader/AppDomainDCStop	1	34	0
Microsoft-Windows-DotNETRuntimeRundown/Method/DCStopComplete	1	2	0

2) NativeAOT
dotnet publish -r win-x64 -c Debug /p:PublishAot=true

C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\EventSource\NativeAOT\bin\Debug\net7.0\win-x64\publish\NativeAotTest.exe
6 MB

C:\work\core\Test\8_18\sdk\Diagnostics\EventSource\PerfView\NativeAOT

a) PerfView (Can NOT see relevant events even though some related events can be seen)
 - C:\work\core\Tools\PerfView.exe
 - launch the app via the collect option
 - add the following to the "Addtional Providers", "Demo:1:4"
  

 - Related Events
Microsoft-Windows-DotNETRuntime/Exception/Start
Microsoft-Windows-DotNETRuntime/GC/AllocationTick
Microsoft-Windows-DotNETRuntime/GC/CreateSegment



b) dotnet-trace
https://docs.microsoft.com/en-us/dotnet/core/diagnostics/dotnet-trace
  Enables the collection of .NET Core traces of a running process without a native profiler.

pushd C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\EventSource\NativeAOT\bin\Debug\net7.0\win-x64\publish

dotnet-trace collect --providers Demo -- NativeAotTest.exe

collect --providers Demo -- C:\work\core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\EventSource\NativeAOT\bin\Debug\net7.0\win-x64\publish\NativeAotTest.exe

PROBABLE CAUSE:
 - EventPipe is not NativeAOT friendly and dotnet tracing tools (dotnet-trace, counters, gcdump) to not work
    + EventPipe port to runtime (C++) was started but needs to happen
    + https://docs.microsoft.com/en-us/dotnet/core/diagnostics/eventpipe
      * However, because EventPipe is a runtime built-in component, its scope is limited to managed code and the runtime itself.
    + It seems to expect the application that is being monitored for trace/logging to be managed (See callstack below)
      * ReversedDiagnosticsServer.Accept time outs
        - private readonly HandleableCollection<IpcEndpointInfo> _endpointInfos = new HandleableCollection<IpcEndpointInfo>();
        - IpcEndpointInfo: Represents a runtine instance connection to a reversed diagnostics server.
  - Read Diagnostics port
    + https://docs.microsoft.com/en-us/dotnet/core/diagnostics/diagnostic-port
      * The .NET Core runtime exposes a service endpoint that allows other processes to send diagnostic commands and receive responses over an IPC channe

POSSIBLE SOLUTION:
  - Make EventPipe handle nativeaot apps as well
    + How? https://docs.microsoft.com/en-us/dotnet/core/diagnostics/diagnostics-client-library

C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\EventSource\NativeAOT\bin\Debug\net7.0\win-x64\publish>dotnet-trace collect --providers Demo -- NativeAotTest.exe

Provider Name                           Keywords            Level               Enabled By
Demo                                    0xFFFFFFFFFFFFFFFF  Verbose(5)          --providers

Launching: NativeAotTest.exe 
Unable to start tracing session - the target app failed to connect to the diagnostics port. This may happen if the target application is running .NET Core 3.1 or older versions. Attaching at startup is only available from .NET 5.0 or later.
[ERROR] System.TimeoutException: The operation has timed out.
   at Microsoft.Diagnostics.NETCore.Client.HandleableCollection`1.Handle(Handler handler, TimeSpan timeout) in /_/src/Microsoft.Diagnostics.NETCore.Client/HandleableCollection.cs:line 156
   at Microsoft.Diagnostics.NETCore.Client.HandleableCollection`1.Handle(TimeSpan timeout) in /_/src/Microsoft.Diagnostics.NETCore.Client/HandleableCollection.cs:line 131
   at Microsoft.Diagnostics.NETCore.Client.ReversedDiagnosticsServer.Accept(TimeSpan timeout) in /_/src/Microsoft.Diagnostics.NETCore.Client/ReversedServer/ReversedDiagnosticsServer.cs:line 141
   at Microsoft.Internal.Common.Utils.DiagnosticsClientBuilder.Build(CancellationToken ct, Int32 processId, String diagnosticPort, Boolean showChildIO, Boolean printLaunchCommand) in /_/src/Tools/Common/ReversedServerHelpers/ReversedServerHelpers.cs:line 225
   at Microsoft.Diagnostics.Tools.Trace.CollectCommandHandler.Collect(CancellationToken ct, IConsole console, Int32 processId, FileInfo output, UInt32 buffersize, String providers, String profile, TraceFileFormat format, TimeSpan duration, String clrevents, String clreventlevel, String name, String diagnosticPort, Boolean showchildio, Boolean resumeRuntime) in /_/src/Tools/dotnet-trace/CommandLine/Commands/CollectCommand.cs:line 157

B) Debugging
Debug 
 - VS: debenv -debugexe <pathToNativeAotExe>
 - Open the source
 - setup a bp and start debugging (F5)

Observations
 - Stack (mangled names but reasonable)
 - Disassebmly has debug symbols
 - F10, F11, Local Views, virtual methods (FEEFEEFOO)
 - Not working: Interface calls
 - Partially working: yield return, state machine

ASK:
- Dump Debugging: to be comtaible with coreclr
	* During development, build time debugging experience will be coreclr (nativeaot comes at publish) and that can be sufficient


C) Dotnet-trace (AOT it)
https://github.com/dotnet/diagnostics
c:\work\core\main\diagnostics

C:\work\core\main\diagnostics\artifacts\bin\dotnet-trace\Release\net7.0\win-x64\publish\dotnet-trace.exe

-----------------

dotnet add package Microsoft.Diagnostics.NETCore.Client --version 0.2.351802

dotnet add package Microsoft.Diagnostics.Tracing.TraceEvent --version 3.0.5

dotnet remove package Microsoft.Diagnostics.Tracing.TraceEvent --version 3.0.5

C:\Work\Core\main\runtime\src\coreclr\tools\aot\ilc.sln
C:\Work\Core\main\runtime\artifacts\bin\repro\x64\Debug\compile-with-Debug-libs.rsp
C:\Work\Core\main\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\reproNative.vcxproj




- Does not work in either main or CurrentWork3
build.cmd clr.aot+libs -rc Release
C:\Work\Core\main\runtime\artifacts\bin\repro\x64\Release\compile-with-Release-libs.rsp
C:\Work\Core\CurrentWork3\runtime\artifacts\bin\repro\x64\Release\compile-with-Release-libs.rsp

 - works in main
 - work in CurrentWork3
build.cmd clr.aot+libs -rc Debug

C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ilc.sln
C:\Work\Core\CurrentWork3\runtime\artifacts\bin\repro\x64\Debug\compile-with-Debug-libs.rsp

C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\reproNative.vcxproj



1>   Creating library C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\x64\Debug\reproNative.lib and object C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\x64\Debug\reproNative.exp
1>Runtime.WorkstationGC.lib(ds-sources.c.obj) : error LNK2019: unresolved external symbol "bool __cdecl ds_ipc_pal_init(void)" (?ds_ipc_pal_init@@YA_NXZ) referenced in function "bool __cdecl ds_server_init(void)" (?ds_server_init@@YA_NXZ)

https://github.com/LakshanF/runtime/blob/ExperimentEventPipe2/src/coreclr/nativeaot/Runtime/diagnosticserveradapter.h#L16

Error	LNK2019	unresolved external symbol "bool __cdecl ds_ipc_pal_init(void)" (?ds_ipc_pal_init@@YA_NXZ) referenced in function "bool __cdecl ds_server_init(void)" (?ds_server_init@@YA_NXZ)	reproNative	C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\Runtime.WorkstationGC.lib(ds-sources.c.obj)	1	

ds_server_init, (void) https://github.com/LakshanF/runtime/blob/ExperimentEventPipe2/src/native/eventpipe/ds-server.c#L200

https://github.com/LakshanF/runtime/blob/ExperimentEventPipe2/src/native/eventpipe/ds-ipc-pal-namedpipe.c#L105


artifacts\obj\coreclr\windows.x64.Debug

C:\Work\Core\CurrentWork3\runtime\artifacts\obj\coreclr\windows.x64.Debug

C:\Work\Core\main\runtime\artifacts\obj\coreclr\windows.x64.Debug

/showIncludes /d1PP /P 



bp coreclr!ep_init


ds_server_init

    __debugbreak();



--------------------------------
ds-ipc.c
bool
ds_ipc_stream_factory_init (void)
{
	ep_ipc_stream_factory_callback_set (ds_ipc_stream_factory_any_suspended_ports);

-->	ds_rt_port_array_alloc (&_ds_port_array);
	--> return ds_rt_port_array_is_valid (&_ds_port_array);
}

-->ds_rt_port_array_alloc (&_ds_port_array);
ds-rt-coreclr.h
DS_RT_DEFINE_ARRAY (port_array, ds_rt_port_array_t, ds_rt_port_array_iterator_t, DiagnosticsPort *)

ep-rt-coreclr.h
template<typename ARRAY_TYPE>
static
inline
void
_rt_coreclr_array_alloc (ARRAY_TYPE *ep_array)
{
	STATIC_CONTRACT_NOTHROW;
	EP_ASSERT (ep_array != NULL);

	ep_array->array = new (nothrow) typename ARRAY_TYPE::array_type_t ();
}


-->ds_rt_port_array_is_valid (&_ds_port_array);
ds-rt-coreclr.h
DS_RT_DEFINE_ARRAY (port_array, ds_rt_port_array_t, ds_rt_port_array_iterator_t, DiagnosticsPort *)

ep-rt-coreclr.h
template<typename ARRAY_TYPE, typename CONST_ARRAY_TYPE = const ARRAY_TYPE>
static
inline
bool
_rt_coreclr_array_is_valid (CONST_ARRAY_TYPE *ep_array)
{
	STATIC_CONTRACT_NOTHROW;
	return (ep_array->array != NULL);
}


---------------------------------------------
Michal's PR, https://github.com/dotnet/runtime/pull/77884
 - C:\Work\Core\CurrentWork2\runtime\src\coreclr\nativeaot\Common\src\Internal\Runtime\CompilerHelpers\StartupCodeHelpers.cs
  + RuntimeImports.RhpCreateTypeManager
  + RuntimeImports.RhGetModuleSection
  + DehydratedDataCommand

------------------------------------------------

dumpbin /HEADERS ep-sources.c.obj>C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\PortEventPipe2\investigate\linker_err\ep-sources_main.txt

/HEADERS
/ALL /RAWDATA:NONE

Build started...
1>------ Build started: Project: reproNative, Configuration: Debug x64 ------
1>main.cpp
1>   Creating library C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\x64\Debug\reproNative.lib and object C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\x64\Debug\reproNative.exp
1>Runtime.WorkstationGC.lib(ep-sources.c.obj) : error LNK2019: unresolved external symbol "__declspec(dllimport) int __cdecl FreeLibrary(void *)" (__imp_?FreeLibrary@@YAHPEAX@Z) referenced in function "void __cdecl sample_profiler_unload_dependencies(void)" (?sample_profiler_unload_dependencies@@YAXXZ)
1>Runtime.WorkstationGC.lib(ep-sources.c.obj) : error LNK2019: unresolved external symbol "struct HWND__ * __cdecl LoadLibraryW(wchar_t const *)" (?LoadLibraryW@@YAPEAUHWND__@@PEB_W@Z) referenced in function "bool __cdecl sample_profiler_load_dependencies(void)" (?sample_profiler_load_dependencies@@YA_NXZ)
1>C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\x64\Debug\reproNative.exe : fatal error LNK1120: 2 unresolved externals
1>Done building project "reproNative.vcxproj" -- FAILED.
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========
========== Elapsed 00:01.284 ==========

C:\Work\Core\main\runtime\artifacts\obj\coreclr\windows.x64.Debug\dlls\mscoree\coreclr


C:\Work\Core\CurrentWork3\runtime\artifacts\obj\coreclr\windows.x64.Debug


C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\PortEventPipe2\investigate\


C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ilc.sln
C:\Work\Core\CurrentWork3\runtime\artifacts\bin\repro\x64\Debug\compile-with-Debug-libs.rsp

C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\reproNative.vcxproj


ep.C
ep_requires_lock_not_held (void)
{
	ep_rt_config_requires_lock_not_held ();
}


windiff \\chrisahnx74\LakshanF\EventPipe\2022_11_17\001\Diff\Old \\chrisahnx74\LakshanF\EventPipe\2022_11_17\001\Diff\New


// 11/20/22
 - Uber Goals 
  + Get lock check working
  + Walk through the code and come up with hypothesis
  + Be in a state to write to Chris for status and next steps

 - Needed steps
  + check in csharp, including Chris notes
  + Get pre-processor files for the following, both main and CurrentWork3, both clean and with errors, both release and debug
    * ds-ipc-pal-namedpipe.c.obj
    * ds-sources.c.obj 
    * startup.cpp.obj 
  + see if above can solve the issue
  + dumpbin and other info to udpate doc and make it current
  + walk through the ep_rt_init and see Michal's suggestions
  + Walk through the rest of the methods for hypothesis
  + Complete walk throughs for the other init methods


Chris notes:

Hi Chris, can you help me with the first runtime implementation please?

For EP init, the lock check method that I talked to you earlier, ep_requires_lock_not_held, uses CrstStatic, https://github.com/dotnet/runtime/blob/main/src/coreclr/nativeaot/Runtime/Crst.h#L37, specifically, 
a EP type, ep_rt_lock_handle_t, gets declared to point to this type https://github.com/LakshanF/runtime/blob/ExperimentEventPipe2/src/coreclr/nativeaot/Runtime/eventpipe/ep-rt-types-aot.h#L134

I thought I can can get the first NativeAOT runtime implementation enabled by commenting back in this type and the method call stack that ends in this code uncommented, https://github.com/LakshanF/runtime/blob/ExperimentEventPipe2/src/coreclr/nativeaot/Runtime/eventpipe/ep-rt-aot.h#L2513, 
and removing all the __debugbreak()

I'm running into problems with trying to get CrstStatic to become visible (it doesn't pose any problems in ep-rt-types-aot.h, I assume due to the fwd declaration there) in ep-rt-aot.h with compiling ds-ipc-pal-namedpipe.c and ds-sources.c. If I add #include <crst.h>, which nativeaot has, to 
ep-rt-aot.h, then startup.cpp starts complaining of member types used by that type (CrstType, CrstFlags etc.). I think this is related to forward_declarations.h having this declared but do not know how to overcome this.





https://stackoverflow.com/questions/4757565/what-are-forward-declarations-in-c


notes
 - Annoying error msg  
C:\Work\Core\CurrentWork3\runtime\src\native\eventpipe\ep-rt-config.h(4): fatal error C1083: Cannot open include file: '../../../inc/ep-shared-config.h': No such file or directory
  + FIX: Needed to change the include file
 - msg2
 C:\Work\Core\CurrentWork3\runtime\src\native\eventpipe\ds-sources.c: fatal error C1083: Cannot open include file: '"C:/Work/Core/CurrentWork3/runtime/src/coreclr/nativeaot/Runtime/eventpipe/NativeaotEventPipeSupport.h"': No such file or directory
  + FIX: /FIC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipe\NativeaotEventPipeSupport.h

/d1PP /P /showIncludes

C:\PROGRA~1\MIB055~1\2022\Preview\VC\Tools\MSVC\1434~1.319\bin\Hostx64\x64\cl.exe /d1PP /P /showIncludes /nologo /TP -DBUILDENV_DEBUG=1 -DDEBUG -DFEATURE_BASICFREEZE -DFEATURE_CACHED_INTERFACE_DISPATCH -DFEATURE_CONSERVATIVE_GC -DFEATURE_CUSTOM_IMPORTS -DFEATURE_DYNAMIC_CODE -DFEATURE_ETW -DFEATURE_EVENT_TRACE -DFEATURE_GC_STRESS -DFEATURE_NATIVEAOT -DFEATURE_PERFTRACING -DFEATURE_RX_THUNKS -DFEATURE_SUSPEND_REDIRECTION -DHOST_64BIT -DHOST_AMD64 -DHOST_WINDOWS -DNATIVEAOT -DTARGET_64BIT -DTARGET_AMD64 -DTARGET_WINDOWS -DUNICODE=1 -DURTBLDENV_FRIENDLY=Debug -DVERIFY_HEAP -D_DBG -D_DEBUG -D_FILE_OFFSET_BITS=64 -D_LIB -IC:\Work\Core\CurrentWork3\runtime\artifacts\obj\coreclr\windows.x64.Debug\nativeaot\Runtime\Full -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\Full -IC:\Work\Core\CurrentWork3\runtime\src\native -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\pal\prebuilt\inc -IC:\Work\Core\CurrentWork3\runtime\artifacts\obj -IC:\Work\Core\CurrentWork3\runtime\src\native\eventpipe -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\inc -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\. -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\..\..\gc -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\..\..\gc\env -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\windows -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\amd64 /DWIN32 /D_WINDOWS    /GR-  /guard:ehcont /Zi /Ob0 /Od /RTC1 -MTd /Od /nologo /W4 /WX /Oi /Oy- /Gm- /Zp8 /Gy /GS /fp:precise /FC /MP /Zm200 /Zc:strictStrings /Zc:wchar_t /Zc:inline /Zc:forScope /wd4065 /wd4100 /wd4127 /wd4131 /wd4189 /wd4200 /wd4201 /wd4206 /wd4239 /wd4245 /wd4291 /wd4310 /wd4324 /wd4366 /wd4456 /wd4457 /wd4458 /wd4459 /wd4463 /wd4505 /wd4702 /wd4706 /wd4733 /wd4815 /wd4838 /wd4918 /wd4960 /wd4961 /wd5105 /wd5205 /we4007 /we4013 /we4102 /we4551 /we4700 /we4640 /we4806 /w34092 /w34121 /w34125 /w34130 /w34132 /w34212 /w34530 /w35038 /w44177 /Zi /ZH:SHA_256 /source-charset:utf-8 /homeparams /EHa /EHa- /EHs- /GL- /Fonativeaot\Runtime\Full\CMakeFiles\Runtime.WorkstationGC.dir\__\startup.cpp.obj /FdTARGET_COMPILE_PDB /FS -c C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\startup.cpp




---------------------------
CORE_ROOT=C:\Work\Core\main2\runtime\artifacts\bin\testhost\net7.0-windows-Debug-x64\shared\Microsoft.NETCore.App\8.0.0\System.Private.CoreLib.dll

$(LocalDebuggerEnvironment)

System.Private.CoreLib.dll

set CORE_ROOT=C:\Work\Core\Johan\runtime\artifacts\bin\testhost\net7.0-windows-Debug-x64\shared\Microsoft.NETCore.App\8.0.0\
C:\Work\Core\Johan\runtime\artifacts\obj\mono\windows.x64.Debug\out\bin
ep-test.exe


C:\Work\Core\Johan\runtime\src\mono\mono\mini\mini-runtime.c

bp ep-test!test_list_length


bp test_session_write_wait_get_next_event

test_eventpipe_setup: OK



C:\ProgramData\Dbg\raw.githubusercontent.com\dotnet\runtime\eecb02807867cad56cd05badddef65e432248b75\src\coreclr\inc\45469fee3d\src\coreclr\inc\volatile.h


--------------------------------
Removing __debugbreak()
 - Plan
  + Remove 203 total
  + Add to EmptyContainer (55)

Remove 204 Breakdown
 - [4] C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipeadapter.h
  + Can replace with C:\Work\Core\CurrentWork3\runtime\src\coreclr\vm\eventpipeadapter.h
 - [12] C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipe\ds-rt-aot.h
  + Remove manually
 - [181] C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipe\ep-rt-aot.h
  + Remove manually
 - [5] C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipe\ep-rt-types-aot.h
   + Remove manually

Add to EmptyContainer (55)

/showIncludes /d1PP /P 

C:\PROGRA~1\MIB055~1\2022\Preview\VC\Tools\MSVC\1434~1.319\bin\Hostx64\x64\cl.exe  /showIncludes /d1PP /P /nologo /TP -DBUILDENV_DEBUG=1 -DDEBUG -DFEATURE_CORECLR -DFEATURE_PERFTRACING -DFEATURE_PERFTRACING_STANDALONE_PAL -DHOST_64BIT -DHOST_AMD64 -DHOST_WINDOWS -DPAL_STDCPP_COMPAT -DTARGET_64BIT -DTARGET_AMD64 -DTARGET_WINDOWS -DURTBLDENV_FRIENDLY=Debug -DWIN32_LEAN_AND_MEAN -D_DBG -D_DEBUG -D_FILE_OFFSET_BITS=64 -IC:\Work\Core\CurrentWork3\runtime\src\native -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\debug\debug-pal\..\inc -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\debug\debug-pal\..\..\pal\inc -IC:\Work\Core\CurrentWork3\runtime\artifacts\obj\coreclr\windows.x64.Debug\inc -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\debug\debug-pal\..\..\inc /DWIN32 /D_WINDOWS    /GR- /guard:cf /guard:ehcont /Zi /Ob0 /Od /RTC1 -MTd /Od /nologo /W4 /WX /Oi /Oy- /Gm- /Zp8 /Gy /GS /fp:precise /FC /MP /Zm200 /Zc:strictStrings /Zc:wchar_t /Zc:inline /Zc:forScope /wd4065 /wd4100 /wd4127 /wd4131 /wd4189 /wd4200 /wd4201 /wd4206 /wd4239 /wd4245 /wd4291 /wd4310 /wd4324 /wd4366 /wd4456 /wd4457 /wd4458 /wd4459 /wd4463 /wd4505 /wd4702 /wd4706 /wd4733 /wd4815 /wd4838 /wd4918 /wd4960 /wd4961 /wd5105 /wd5205 /we4007 /we4013 /we4102 /we4551 /we4700 /we4640 /we4806 /w34092 /w34121 /w34125 /w34130 /w34132 /w34212 /w34530 /w35038 /w44177 /Zi /ZH:SHA_256 /source-charset:utf-8 /homeparams /EHa /Fodebug\debug-pal\CMakeFiles\debug-pal_obj.dir\C_\Work\Core\CurrentWork3\runtime\src\native\eventpipe\ds-ipc-pal-namedpipe.c.obj /FdTARGET_COMPILE_PDB /FS -c C:\Work\Core\CurrentWork3\runtime\src\native\eventpipe\ds-ipc-pal-namedpipe.c

C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\PortEventPipe2\investigate
C:\Work\Core\LakshanF\CSharp\src\aot\experiments\Diagnostics\Logging\PortEventPipe2\investigate\CrstStatic\main\ds-ipc-pal-namedpipe.i

1) ep_rt_entrypoint_assembly_name_get_utf8, https://github.com/LakshanF/runtime/blob/ExperimentEventPipe2/src/coreclr/nativeaot/Runtime/eventpipe/ep-rt-aot.h#L1127,
return empty string but TODO to return filename

2) ep_rt_runtime_version_get_utf8, https://github.com/LakshanF/runtime/blob/ExperimentEventPipe2/src/coreclr/nativeaot/Runtime/eventpipe/ep-rt-aot.h#L1151
Jan => "Try returning RuntimeProductVersion - it is a macro that should be defined by the build."
src\coreclr\inc\clrversion.h, has a reference to this but not sure what "defined by the build means"

// TODO: Find a way to use CoreCLR runtime_version.h here if a more exact version is needed

return reinterpret_cast<const ep_char8_t*>("8.0.0");

3) Exchange InterlockedCompareExchangeT<=>PalInterlockedExchange, src\coreclr\nativeaot\Runtime\unix\PalRedhawkInline.h
[NEED_HELP]     typedef unsigned __int64 size_t;
EXTERN_C long __PN__MACHINECALL_CDECL_OR_DEFAULT _InterlockedExchange(long volatile *, long);
#pragma intrinsic(_InterlockedExchange)
FORCEINLINE int32_t PalInterlockedExchange(_Inout_ int32_t volatile *pDst, int32_t iValue)
{
    return _InterlockedExchange((long volatile *)pDst, iValue);
}

4) ep_rt_method_get_full_name, Issue with MethodDesc (now on managed?) src\coreclr\nativeaot\Runtime\eventtracebase.h (etw related?) uses this but not sure how that works (perhaps reverse PINvokes?)
// TODO: Design MethodDesc and method name services if/when needed
__debugbreak();

5) EX_TRY macros 
error C2065: 'EX_TRY': undeclared identifier

In the NativeAOT runtime, C++ code is never allowed to handle any exceptions in any way.  This is even enforced by passing "/EHa- /EHs-" on the cl.exe command line due to these settings in src\coreclr\nativeaot\CMakeLists.txt:

6) ep_rt_method_get_full_name, SString, src\coreclr\inc\sstring.h
Similar to MethodDesc, in that ETW (eventtrace*.*) seems to be using this

@TODO - figure out the way to do this in NativeAOT

// TODO: Design MethodDesc and method name services if/when needed
__debugbreak();

7) CLRConfig::GetConfigValue - how does nativeaot get config values? Eventtrace uses this in NativeAOT but seems under #ifndef FEATURE_NATIVEAOT

https://github.com/dotnet/runtime/blob/main/src/coreclr/vm/eventing/eventpipe/ep-rt-coreclr.h#L1309

INTERNAL_EventPipeProcNumbers, INTERNAL_EnableEventPipe, INTERNAL_EventPipeConfig, INTERNAL_EventPipeOutputPath, INTERNAL_EventPipeCircularMB, INTERNAL_EventPipeOutputStreaming, INTERNAL_EventPipeRundown

 - g_pRhConfig->ReadConfigValue
 extern RhConfig * g_pRhConfig;
 https://github.com/dotnet/runtime/blob/main/src/coreclr/nativeaot/Runtime/RhConfig.h#L20

Waiting for Michal

// TODO: EventPipe Configuration values - RhConfig?

	// TODO: EventPipe Configuration values - RhConfig?
	__debugbreak();
	return false;

8) ep_rt_provider_config_init
MICROSOFT_WINDOWS_DOTNETRUNTIME_RUNDOWN_PROVIDER_DOTNET_Context is not available in NativeAOT

	// TODO: MICROSOFT_WINDOWS_DOTNETRUNTIME_RUNDOWN_PROVIDER_DOTNET_Context is not available in NativeAOT
	__debugbreak();

9) ep_rt_notify_profiler_provider_created
#ifndef DACCESS_COMPILE
		BEGIN_PROFILER_CALLBACK (CORProfilerTrackEventPipe ());
		(&g_profControlBlock)->EventPipeProviderCreated (provider);
		END_PROFILER_CALLBACK ();
#endif // DACCESS_COMPILE

src\coreclr\inc\profilepriv.inl
FORCEINLINE BOOL CORProfilerTrackEventPipe()
{
    STATIC_CONTRACT_LIMITED_METHOD;

    return (&g_profControlBlock)->globalEventMask.IsEventMaskHighSet(COR_PRF_HIGH_MONITOR_EVENT_PIPE);
}

	// TODO: EventPipe profiler callback needed
	__debugbreak();

10) ep_rt_wait_event_alloc, use of undefined type 'CLREventStatic'

C:\Work\Core\main\runtime\src\coreclr\vm\synch.h

C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\event.h
 ues NoThrow versions, CreateManualEventNoThrow & CreateAutoEventNoThrow

11) ep_rt_wait_event_get_wait_handle, NativeAOT CLREventStatic doesn't have GetHandleUNHOSTED
	// TODO: 
	__debugbreak();

12) ep_rt_process_detach (void)
g_fProcessDetach, g_fEEShutDown,  not defined

NativeAOT seems not to have a concept of process detach, although there is a reference to DLL_PROCESS_DETACH

	// TODO: 
	__debugbreak();

------------------------------------------------------------------------

13) EP_RT_DEFINE_THREAD_FUNC (ep_rt_thread_aot_start_func)
	DWORD result = thread_params->thread_params.thread_func (thread_params);
	if (thread_params->thread_params.thread)
		::DestroyThread (thread_params->thread_params.thread);
C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipe\ep-rt-aot.h(1934): warning C4267: 'initializing': conversion from 'size_t' to 'DWORD', possible loss of data
C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipe\ep-rt-aot.h(1936): error C2039: 'DestroyThread': is not a member of '`global namespace''
  
		// thread_params->thread_params.thread == ep_rt_thread_handle_t == Thread
		// CoreCLR ::DestroyThread (thread_params->thread_params.thread);

		thread_params->thread_params.thread->Destroy();

Include coreclr\nativeaot\Runtime\thread.h

14) [NEED_HELP] nativeaot\Runtime\thread.h(62): error C3646: 'm_kind': unknown override specifier, lots of errors with #include <thread.h> at
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(62): error C3646: 'm_kind': unknown override specifier
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(62): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(65): error C2079: 'ExInfo::m_frameIter' uses undefined class 'StackFrameIterator'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(82): error C2143: syntax error: missing ';' before '*'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(82): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(82): error C2238: unexpected token(s) preceding ';'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(83): error C2143: syntax error: missing ';' before '*'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(83): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(83): error C2238: unexpected token(s) preceding ';'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(84): error C2143: syntax error: missing ';' before '*'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(84): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(84): error C2238: unexpected token(s) preceding ';'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(114): error C2143: syntax error: missing ';' before '*'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(114): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(114): error C2238: unexpected token(s) preceding ';'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(121): error C3856: 'DefaultSListTraits': symbol is not a class template
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(121): error C2098: unexpected token after data member 'Thread'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(121): error C2059: syntax error: '>'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(181): error C2143: syntax error: missing ';' before '*'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(181): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(181): error C2238: unexpected token(s) preceding ';'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(244): error C2143: syntax error: missing ';' before '*'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(244): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(244): error C2238: unexpected token(s) preceding ';'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(257): error C2061: syntax error: identifier 'PInvokeTransitionFrame'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(273): error C2061: syntax error: identifier 'PInvokeTransitionFrame'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(280): error C2061: syntax error: identifier 'PInvokeTransitionFrame'
  C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\thread.h(281): error C2061: syntax error: identifier 'PInvokeTransitionFrame'

15) ep_rt_thread_create, how to start thread?
  thread_params->thread_params.thread = SetupUnstartedThread ();

16) 

unsigned int COUNT_T


C:\PROGRA~1\MIB055~1\2022\Preview\VC\Tools\MSVC\1434~1.319\bin\Hostx64\x64\cl.exe /showIncludes /d1PP /P /nologo /TP -DBUILDENV_DEBUG=1 -DDEBUG -DFEATURE_BASICFREEZE -DFEATURE_CACHED_INTERFACE_DISPATCH -DFEATURE_CONSERVATIVE_GC -DFEATURE_CUSTOM_IMPORTS -DFEATURE_DYNAMIC_CODE -DFEATURE_ETW -DFEATURE_EVENT_TRACE -DFEATURE_GC_STRESS -DFEATURE_NATIVEAOT -DFEATURE_PERFTRACING -DFEATURE_RX_THUNKS -DFEATURE_SUSPEND_REDIRECTION -DHOST_64BIT -DHOST_AMD64 -DHOST_WINDOWS -DNATIVEAOT -DTARGET_64BIT -DTARGET_AMD64 -DTARGET_WINDOWS -DUNICODE=1 -DURTBLDENV_FRIENDLY=Debug -DVERIFY_HEAP -D_DBG -D_DEBUG -D_FILE_OFFSET_BITS=64 -D_LIB -IC:\Work\Core\CurrentWork3\runtime\artifacts\obj\coreclr\windows.x64.Debug\nativeaot\Runtime\Full -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\Full -IC:\Work\Core\CurrentWork3\runtime\src\native -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\pal\prebuilt\inc -IC:\Work\Core\CurrentWork3\runtime\artifacts\obj -IC:\Work\Core\CurrentWork3\runtime\src\native\eventpipe -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\inc -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\. -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\..\..\gc -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\..\..\gc\env -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\windows -IC:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\amd64 /DWIN32 /D_WINDOWS    /GR-  /guard:ehcont /Zi /Ob0 /Od /RTC1 -MTd /Od /nologo /W4 /WX /Oi /Oy- /Gm- /Zp8 /Gy /GS /fp:precise /FC /MP /Zm200 /Zc:strictStrings /Zc:wchar_t /Zc:inline /Zc:forScope /wd4065 /wd4100 /wd4127 /wd4131 /wd4189 /wd4200 /wd4201 /wd4206 /wd4239 /wd4245 /wd4291 /wd4310 /wd4324 /wd4366 /wd4456 /wd4457 /wd4458 /wd4459 /wd4463 /wd4505 /wd4702 /wd4706 /wd4733 /wd4815 /wd4838 /wd4918 /wd4960 /wd4961 /wd5105 /wd5205 /we4007 /we4013 /we4102 /we4551 /we4700 /we4640 /we4806 /w34092 /w34121 /w34125 /w34130 /w34132 /w34212 /w34530 /w35038 /w44177 /Zi /ZH:SHA_256 /source-charset:utf-8 /homeparams /EHa /EHa- /EHs- /GL- /Fonativeaot\Runtime\Full\CMakeFiles\Runtime.WorkstationGC.dir\__\startup.cpp.obj /FdTARGET_COMPILE_PDB /FS -c C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\startup.cpp

C:\PROGRA~1\MIB055~1\2022\Preview\VC\Tools\MSVC\1434~1.319\bin\Hostx64\x64\cl.exe  /showIncludes /d1PP /P  /nologo /TP -DBUILDENV_DEBUG=1 -DDEBUG -DDEBUGGING_SUPPORTED -DEnC_SUPPORTED -DFEATURE_ARRAYSTUB_AS_IL -DFEATURE_BASICFREEZE -DFEATURE_CODE_VERSIONING -DFEATURE_COLLECTIBLE_TYPES -DFEATURE_COMINTEROP -DFEATURE_COMINTEROP_APARTMENT_SUPPORT -DFEATURE_COMINTEROP_UNMANAGED_ACTIVATION -DFEATURE_COMWRAPPERS -DFEATURE_CORECLR -DFEATURE_DATABREAKPOINT -DFEATURE_DEFAULT_INTERFACES -DFEATURE_EH_FUNCLETS -DFEATURE_ENC_SUPPORTED -DFEATURE_EVENT_TRACE -DFEATURE_HIJACK -DFEATURE_ICASTABLE -DFEATURE_INSTANTIATINGSTUB_AS_IL -DFEATURE_INTEROP_DEBUGGING -DFEATURE_ISYM_READER -DFEATURE_MANAGED_ETW -DFEATURE_MANAGED_ETW_CHANNELS -DFEATURE_MANUALLY_MANAGED_CARD_BUNDLES -DFEATURE_MULTICASTSTUB_AS_IL -DFEATURE_MULTICOREJIT -DFEATURE_ON_STACK_REPLACEMENT -DFEATURE_PERFTRACING -DFEATURE_PGO -DFEATURE_PORTABLE_SHUFFLE_THUNKS -DFEATURE_PROFAPI_ATTACH_DETACH -DFEATURE_READYTORUN -DFEATURE_REJIT -DFEATURE_SPECIAL_USER_MODE_APC -DFEATURE_STANDALONE_GC -DFEATURE_SVR_GC -DFEATURE_SYMDIFF -DFEATURE_TIERED_COMPILATION -DFEATURE_TYPEEQUIVALENCE -DFEATURE_USE_ASM_GC_WRITE_BARRIERS -DFEATURE_USE_SOFTWARE_WRITE_WATCH_FOR_GC_HEAP -DFEATURE_WIN32_REGISTRY -DHOST_64BIT -DHOST_AMD64 -DHOST_WINDOWS -DOUT_OF_PROCESS_SETTHREADCONTEXT -DPROFILING_SUPPORTED -DTARGET_64BIT -DTARGET_AMD64 -DTARGET_WINDOWS -DUNICODE -DUNIX_AMD64_ABI_ITF -DURTBLDENV_FRIENDLY=Debug -DWIN32 -DWIN32_LEAN_AND_MEAN -DWINVER=0x0602 -DWRITE_BARRIER_CHECK -D_BLD_CLR -D_CRT_SECURE_NO_WARNINGS -D_DBG -D_DEBUG -D_FILE_OFFSET_BITS=64 -D_SECURE_SCL=0 -D_UNICODE -D_WIN32 -D_WIN32_WINNT=0x0602 -IC:\Work\Core\main\runtime\artifacts\obj\coreclr\windows.x64.Debug\vm\wks -IC:\Work\Core\main\runtime\src\coreclr\vm\wks -IC:\Work\Core\main\runtime\src\coreclr\vm -IC:\Work\Core\main\runtime\src\native -IC:\Work\Core\main\runtime\src\coreclr\pal\prebuilt\inc -IC:\Work\Core\main\runtime\artifacts\obj -IC:\Work\Core\main\runtime\src\coreclr\inc -IC:\Work\Core\main\runtime\src\coreclr\debug\inc -IC:\Work\Core\main\runtime\src\coreclr\debug\inc\amd64 -IC:\Work\Core\main\runtime\src\coreclr\debug\inc\dump -IC:\Work\Core\main\runtime\src\coreclr\md\inc -IC:\Work\Core\main\runtime\src\coreclr\classlibnative\bcltype -IC:\Work\Core\main\runtime\src\coreclr\classlibnative\cryptography -IC:\Work\Core\main\runtime\src\coreclr\classlibnative\inc -IC:\Work\Core\main\runtime\artifacts\obj\coreclr\windows.x64.Debug\inc -IC:\Work\Core\main\runtime\src\coreclr\hosts\inc -IC:\Work\Core\main\runtime\src\coreclr\minipal -IC:\Work\Core\main\runtime\artifacts\obj\coreclr\windows.x64.Debug\inc\etw -IC:\Work\Core\main\runtime\src\coreclr\vm\amd64 -IC:\Work\Core\main\runtime\src\coreclr\vm\..\interop\inc -IC:\Work\Core\main\runtime\src\native\libs\System.IO.Compression.Native -IC:\Work\Core\main\runtime\src\native\libs\Common -IC:\Work\Core\main\runtime\src\coreclr\vm\eventing\eventpipe /DWIN32 /D_WINDOWS    /GR- /guard:cf /guard:ehcont /Zi /Ob0 /Od /RTC1 -MTd /Od /nologo /W4 /WX /Oi /Oy- /Gm- /Zp8 /Gy /GS /fp:precise /FC /MP /Zm200 /Zc:strictStrings /Zc:wchar_t /Zc:inline /Zc:forScope /wd4065 /wd4100 /wd4127 /wd4131 /wd4189 /wd4200 /wd4201 /wd4206 /wd4239 /wd4245 /wd4291 /wd4310 /wd4324 /wd4366 /wd4456 /wd4457 /wd4458 /wd4459 /wd4463 /wd4505 /wd4702 /wd4706 /wd4733 /wd4815 /wd4838 /wd4918 /wd4960 /wd4961 /wd5105 /wd5205 /we4007 /we4013 /we4102 /we4551 /we4700 /we4640 /we4806 /w34092 /w34121 /w34125 /w34130 /w34132 /w34212 /w34530 /w35038 /w44177 /Zi /ZH:SHA_256 /source-charset:utf-8 /homeparams /EHa /Zl /YuC:/Work/Core/main/runtime/artifacts/obj/coreclr/windows.x64.Debug/vm/wks/CMakeFiles/cee_wks_obj.dir/cmake_pch.hxx /FpC:/Work/Core/main/runtime/artifacts/obj/coreclr/windows.x64.Debug/vm/wks/CMakeFiles/cee_wks_obj.dir/./cmake_pch.cxx.pch /FIC:/Work/Core/main/runtime/artifacts/obj/coreclr/windows.x64.Debug/vm/wks/CMakeFiles/cee_wks_obj.dir/cmake_pch.hxx /Fovm\wks\CMakeFiles\cee_wks_obj.dir\__\ceemain.cpp.obj /FdTARGET_COMPILE_PDB /FS -c C:\Work\Core\main\runtime\src\coreclr\vm\ceemain.cpp

-------------------------------

1>   
reproNative.exe!SListElem_EP<_EventPipeProvider *>::SListElem_EP<_EventPipeProvider *><_EventPipeProvider * &>(_EventPipeProvider * & val) Line 174	C++
 	reproNative.exe!_rt_aot_list_append<_rt_aot_list_internal_t<_EventPipeProvider *>,_EventPipeProvider *>(_rt_aot_list_internal_t<_EventPipeProvider *> * list, _EventPipeProvider * item) Line 115	C++
 	reproNative.exe!ep_rt_provider_list_append(_rt_aot_list_internal_t<_EventPipeProvider *> * list, _EventPipeProvider * item) Line 1536	C++
 	reproNative.exe!config_register_provider(_EventPipeConfiguration * config, _EventPipeProvider * provider, _EventPipeProviderCallbackDataQueue * provider_callback_data_queue) Line 99	C++
 	reproNative.exe!config_create_provider(_EventPipeConfiguration * config, const char * provider_name, void(*)(const unsigned char *, unsigned long, unsigned char, unsigned __int64, unsigned __int64, _EventFilterDescriptor *, void *) callback_func, void(*)(void(*)(const unsigned char *, unsigned long, unsigned char, unsigned __int64, unsigned __int64, _EventFilterDescriptor *, void *), void *) callback_data_free_func, void * callback_data, _EventPipeProviderCallbackDataQueue * provider_callback_data_queue) Line 479	C++
 	reproNative.exe!provider_create_register(const char * provider_name, void(*)(const unsigned char *, unsigned long, unsigned char, unsigned __int64, unsigned __int64, _EventFilterDescriptor *, void *) callback_func, void(*)(void(*)(const unsigned char *, unsigned long, unsigned char, unsigned __int64, unsigned __int64, _EventFilterDescriptor *, void *), void *) callback_data_free_func, void * callback_data, _EventPipeProviderCallbackDataQueue * provider_callback_data_queue) Line 449	C++
 	reproNative.exe!ep_config_init(_EventPipeConfiguration * config) Line 176	C++
 	reproNative.exe!ep_init() Line 1340	C++
 	reproNative.exe!EventPipeAdapter::Initialize() Line 167	C++
 	reproNative.exe!InitDLL(void * hPalInstance) Line 91	C++
 	reproNative.exe!RhInitialize() Line 494	C++
 	reproNative.exe!InitializeRuntime() Line 151	C++
 	reproNative.exe!wmain(int argc, wchar_t * * argv) Line 198	C++
 	reproNative.exe!invoke_main() Line 91	C++


C:\Work\Core\CurrentWork3\runtime\src\coreclr\nativeaot\Runtime\eventpipe\ep-rt-aot.cpp

-----------------------------------
C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ilc.sln
C:\Work\Core\CurrentWork3\runtime\artifacts\bin\repro\x64\Debug\compile-with-Debug-libs.rsp

C:\Work\Core\CurrentWork3\runtime\src\coreclr\tools\aot\ILCompiler\reproNative\reproNative.vcxproj


https://github.com/dotnet/runtime/issues/69739

-----------------------------------



\\chrisahnx74\LakshanF\EventPipe\2022_11_28\New \\chrisahnx74\LakshanF\EventPipe\2022_11_28\Latest

---------------------------------


ep_rt_provider_config_init 